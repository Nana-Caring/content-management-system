<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>@ViewData["Title"] - CMS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/css/site.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
    <style>
        /* Notification styles */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1050;
            max-width: 350px;
        }
        
        .notification {
            margin-bottom: 10px;
            animation: slideIn 0.3s ease-out;
        }
        
        @@keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .sidebar-toggle {
            display: none;
        }
        
        @@media (max-width: 768px) {
            .sidebar-toggle {
                display: block;
                position: fixed;
                top: 10px;
                left: 10px;
                z-index: 1051;
                background: #343a40;
                color: white;
                border: none;
                padding: 8px 12px;
                border-radius: 4px;
            }
            
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .sidebar.show {
                transform: translateX(0);
            }
            
            main {
                margin-left: 0 !important;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div id="loadingMessage" class="mt-2">Loading...</div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- Sidebar Toggle for Mobile -->
    <button class="sidebar-toggle" onclick="cms.state.toggleSidebar()">
        <i class="bi bi-list"></i>
    </button>

    <div class="container-fluid">
        <div class="row flex-nowrap">
            <nav id="sidebar" class="col-auto col-md-3 col-xl-2 px-sm-2 px-0 bg-dark sidebar" style="min-height: 100vh; position: fixed; left: 0; top: 0;">
                <div class="d-flex flex-column align-items-center align-items-sm-start px-3 pt-2 text-white min-vh-100" style="height: 100vh;">
                    <a href="/" class="d-flex align-items-center pb-3 mb-md-0 me-md-auto text-white text-decoration-none">
                    </a>
                    <img src="~/images/logo.jpg" alt="Logo" style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover; margin: 0 auto 5px auto; display: block;" />
                    <ul class="nav nav-pills flex-column mb-sm-auto mb-0 align-items-start w-100" id="menu" style="font-size: 0.90rem;">
                        <li class="nav-item w-100">
                            <a asp-page="/Index" class="nav-link text-white px-2 w-100 d-flex align-items-center justify-content-start">
                                <i class="bi bi-speedometer2 me-2"></i> Dashboard
                            </a>
                        </li>
                        <li class="w-100">
                            <a asp-page="/Users/Index" class="nav-link text-white px-2 w-100 d-flex align-items-center justify-content-start">
                                <i class="bi bi-people me-2"></i> Users
                            </a>
                        </li>
                        <li class="w-100">
                            <a asp-page="/Accounts/Index" class="nav-link text-white px-2 w-100 d-flex align-items-center justify-content-start">
                                <i class="bi bi-wallet2 me-2"></i> Accounts
                            </a>
                        </li>
                        <li class="w-100">
                            <a asp-page="/Transactions/Index" class="nav-link text-white px-2 w-100 d-flex align-items-center justify-content-start">
                                <i class="bi bi-arrow-left-right me-2"></i> Transactions
                            </a>
                        </li>
                        <li class="w-100">
                            <a asp-page="/Products/Index" class="nav-link text-white px-2 w-100 d-flex align-items-center justify-content-start">
                                <i class="bi bi-box-seam me-2"></i> Products
                            </a>
                        </li>
                        <li class="w-100">
                            <a asp-page="/KYC/Index" class="nav-link text-white px-2 w-100 d-flex align-items-center justify-content-start">
                                <i class="bi bi-shield-check me-2"></i> KYC Verification
                            </a>
                        </li>
                    </ul>
                    <div class="flex-grow-1"></div>
                    <div class="w-100 d-flex flex-row align-items-start justify-content-start mb-4" style="gap: 0.5rem;">
                        <a href="/Profile" class="text-white mb-2" title="Profile">
                            <i class="bi bi-person-circle" style="font-size: 1.1rem;"></i>
                        </a>
                        <a href="/Settings" class="text-white mb-2" title="Settings">
                            <i class="bi bi-gear" style="font-size: 1.1rem;"></i>
                        </a>
                        <div class="position-relative">
                            <a href="/Notifications" class="text-white mb-2" title="Notifications">
                                <i class="bi bi-bell" style="font-size: 1.1rem;"></i>
                                <span id="notificationBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="display: none;">
                                    0
                                </span>
                            </a>
                        </div>
                        <a asp-page="/Logout" class="text-white mb-2" title="Sign Out">
                            <i class="bi bi-box-arrow-right" style="font-size: 1.1rem;"></i>
                        </a>
                    </div>
                </div>
            </nav>
            <main class="col py-3" style="margin-left: 220px;">
                @RenderBody()
            </main>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/state-manager.js"></script>
    <script src="~/js/site.js"></script>
    
    <script>
        // Simple initialization
        document.addEventListener('DOMContentLoaded', function() {
            console.log('CMS loaded');
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
